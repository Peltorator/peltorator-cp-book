---
title: "Минимальная покрывающая окружность за $O(n)$"
date: 2021-09-14T13:10:00+03:00
draft: false
---

<center> <h2>Минимальная покрывающая окружность $O(n)$</h2> </center>
<br/>
<br/>

Решим за линейное время следующую задачу:

**Задача:**
Даны $n$ точек на плоскости. Требуется найти окружность минимального радиуса, такую что все данные точки лежат внутри или на границе этой окружности.


В отличие от других рассмотренных рандомизированных геометрических алгоритмов, у которых есть общеизвестные детерминированные аналоги, работающие в $\log n$ раз дольше, в данном случае рандомизированное решение будет единственным применимым с практической точки зрения.

Есть два варианта того, как будет выглядеть минимальная покрывающая окружность: либо это описанная окружность какой-то тройки из данных точек, либо окружность, построенная на отрезке между двумя какими-то точками как на диаметре, потому что во всех других случаях ее радиус можно немного уменьшить так, чтобы эта окружность все еще содержала в себе все данные точки.

<!---
<script type="text/tikz">
\definecolor{ududff}{rgb}{0.30196078431372547,0.30196078431372547,1.}

\begin{tikzpicture}[line cap=round,line join=round,x=1.0cm,y=1.0cm]
%\clip(1.9532993692172027,-5.315606491485562) rectangle (22.418083000629153,7.063910164237411);
\draw [line width=2.pt] (6.945547737616033,-1.3701101896033616) circle (2.15982720768932cm);
\draw [line width=2.pt] (12.353435313049506,-1.4407171317673966) circle (2.261063915530779cm);
\begin{scriptsize}
\draw [fill=ududff] (5.291407518931119,0.018656782931653123) circle (2.5pt);
\draw [fill=ududff] (9.01532716333559,-0.7529662064494537) circle (2.5pt);
\draw [fill=ududff] (5.9,-3.26) circle (2.5pt);
\draw [fill=ududff] (10.474701078034638,-0.18263617081993994) circle (2.5pt);
\draw [fill=ududff] (14.232169548064373,-2.6987980927148527) circle (2.0pt);
\end{scriptsize}
\end{tikzpicture}
</script>
--->
![test](/images/min_circle_examples.svg)

Давайте по очереди добавлять точки в случайном порядке, поддерживая минимальную покрывающую окружность текущего набора точек. Если новая точка лежит внутри текущей окружности, то ничего менять не надо, а в противном случае нужно перестроить окружность. Стоит заметить, что если новая точка не лежит в старой окружности, то она обязана лежать на новой минимальной окружности. На окружности лежит $3$ точки, поэтому вероятность такого события — $\frac{3}{k}$, где $k$ — индекс новой точки (если на окружности лежит больше $3$ точек, то эта окружность была минимальной еще до добавления текущей точки, а если окружность построена на двух точках как на диаметре, то вероятность еще меньше — $\frac{2}{k}$). Теперь если мы построим линейный алгоритм, который находит минимальную покрывающую окружность, проходящую через новую точку, то итоговая асимптотика алгоритма будет $\sum_{k = 1}^{n} \frac{3}{k} \cdot k = \sum_{k = 1}^{n} 3 = 3n = O(n)$.

<!---
<script type="text/tikz">
\begin{tikzpicture}[line cap=round,line join=round,x=1.0cm,y=1.0cm]
%\clip(0.5970946385918617,-5.021501998660121) rectangle (14.329747363302438,3.2856272725172593);
\draw [line width=2.pt] (7.309601593625497,-1.3147011952191234) circle (3.194715623859915cm);
\begin{scriptsize}
\draw [fill=ududff] (7.3,1.88) circle (2.5pt);
\draw [fill=ududff] (4.24,-2.2) circle (2.5pt);
\draw [fill=ududff] (10.26,-2.54) circle (2.5pt);
\draw [fill=ududff] (7.58,0.24) circle (2.5pt);
\draw [fill=ududff] (6.08,-0.84) circle (2.5pt);
\draw [fill=ududff] (8.52,-3.54) circle (2.5pt);
\draw [fill=ududff] (8.92,-0.76) circle (2.5pt);
\draw [fill=ududff] (6.4,-2.92) circle (2.5pt);
\draw [fill=red] (4.08,0.79) circle (2.5pt);
\end{scriptsize}
\end{tikzpicture}
</script>
--->
![test](/images/min_circle_rebuild.svg)

Алгоритм нахождения минимальной покрывающей окружности, проходящей через новую точку аналогичен алгоритму, который мы только что рассмотрели. Мы перебираем все остальные точки в случайном порядке, и если новая точка лежит вне текущей окружности, то эту окружность нужно перестроить. Вероятность того, что новая точка лежит на минимальной окружности не больше $\frac{2}{k}$, поэтому алгоритм будет линейным.

Остается последний этап: зафиксированы уже две точки и нужно построить минимальную покрывающую окружность, проходящую через них. Алгоритм аналогичен. Начинаем с окружности, построенной на отрезке между этими двумя точками как на диаметре, а затем добавляем остальные точки в случайном порядке. Вероятность, что окружность нужно перестроить не больше $\frac{1}{k}$, при этом если зафиксированы уже три точки на окружности, то окружность определяется однозначно.


